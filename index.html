<!-- üëâ –ü–û–ú–ï–°–¢–ò –í–ú–ï–°–¢–û –¢–ï–ö–£–©–ï–ì–û movie.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#111">
  <title>TopKino ‚Äî –î–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞</title>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FPMXGR1HF9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FPMXGR1HF9');

    function setPageMeta(title, description) {
      document.title = title;
      const meta = document.querySelector('meta[name="description"]') || document.createElement('meta');
      meta.name = "description";
      meta.content = description;
      document.head.appendChild(meta);
    }
  </script>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: #eee;
      padding: 15px;
    }
    a {
      color: #00aaff;
      text-decoration: none;
      display: inline-block;
      margin-bottom: 20px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .poster {
      width: 300px;
      height: 450px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      object-fit: cover;
      background-color: #222;
    }
    .details {
      flex: 1;
      min-width: 280px;
      max-width: 600px;
    }
    .video-wrapper {
      margin: 40px auto 20px;
      width: 100%;
      max-width: 800px;
      aspect-ratio: 16 / 9;
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      background: #000;
      cursor: pointer;
    }
    .video-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .play-button {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 64px;
      height: 64px;
      background: rgba(0,0,0,0.7);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .play-button::before {
      content: '';
      border-style: solid;
      border-width: 12px 0 12px 20px;
      border-color: transparent transparent transparent white;
    }
    .seo-text {
      background: #1a1a1a;
      padding: 20px;
      margin-top: 40px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      line-height: 1.6;
    }
    .seo-text h2 {
      margin-top: 0;
      color: #00aaff;
    }
  </style>
</head>
<body>

<a href="/index.html">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —Ñ–∏–ª—å–º–æ–≤</a>

<div class="container">
  <img class="poster" src="" alt="–ü–æ—Å—Ç–µ—Ä —Ñ–∏–ª—å–º–∞">
  <div class="details">
    <h1 id="mainTitle"></h1>
    <p id="releaseDate"></p>
    <p id="director"></p>
    <p id="actors"></p>
    <p class="description"></p>
    <p id="rating"></p>
  </div>
</div>

<div class="video-wrapper" id="videoWrapper" style="display:none;">
  <img id="videoThumb" src="" alt="–¢—Ä–µ–π–ª–µ—Ä">
  <div class="play-button"></div>
</div>

<div class="seo-text" id="seoText"></div>

<script>
  const API_KEY = '7cb67565ace3a08cd9d099c749787121';
  const IMG_URL = 'https://image.tmdb.org/t/p/w500';
  const movieId = location.pathname.split('/').pop().split('-')[0];
  const seoTextEl = document.getElementById('seoText');

  async function loadMovie() {
    const movieRes = await fetch(`https://api.themoviedb.org/3/movie/${movieId}?api_key=${API_KEY}&language=ru-RU`);
    const movie = await movieRes.json();

    const creditsRes = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/credits?api_key=${API_KEY}&language=ru-RU`);
    const credits = await creditsRes.json();

    const director = credits.crew.find(p => p.job === 'Director')?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω';
    const actors = credits.cast.slice(0, 3).map(a => a.name);
    const genres = movie.genres.map(g => g.name);
    const poster = movie.poster_path ? IMG_URL + movie.poster_path : 'https://via.placeholder.com/300x450';

    document.querySelector('.poster').src = poster;
    document.getElementById('mainTitle').textContent = `${movie.title} (${movie.release_date.slice(0,4)})`;
    document.getElementById('releaseDate').textContent = `–î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞: ${movie.release_date}`;
    document.getElementById('director').textContent = `–†–µ–∂–∏—Å—Å—ë—Ä: ${director}`;
    document.getElementById('actors').textContent = `–ê–∫—Ç—ë—Ä—ã: ${actors.join(', ')}`;
    document.querySelector('.description').textContent = movie.overview;
    document.getElementById('rating').textContent = `–†–µ–π—Ç–∏–Ω–≥ TMDB: ${movie.vote_average.toFixed(1)} (${movie.vote_count} –≥–æ–ª–æ—Å–æ–≤)`;

    setPageMeta(
      `–°–º–æ—Ç—Ä–µ—Ç—å —Ñ–∏–ª—å–º ${movie.title} (${movie.release_date.slice(0,4)}) ‚Äî —Ç—Ä–µ–π–ª–µ—Ä, –æ–ø–∏—Å–∞–Ω–∏–µ`,
      `–§–∏–ª—å–º ¬´${movie.title}¬ª (${movie.release_date.slice(0,4)}) ‚Äî —Ç—Ä–µ–π–ª–µ—Ä, –∞–∫—Ç–µ—Ä—ã, –æ–ø–∏—Å–∞–Ω–∏–µ —Å—é–∂–µ—Ç–∞. –†–µ–∂–∏—Å—Å—ë—Ä: ${director}. –ñ–∞–Ω—Ä—ã: ${genres.join(', ')}.`
    );

    // SEO —Ç–µ–∫—Å—Ç
    seoTextEl.innerHTML = `
      <h2>${movie.title} ‚Äî —Å–º–æ—Ç—Ä–µ—Ç—å –æ–Ω–ª–∞–π–Ω</h2>
      <p>–§–∏–ª—å–º ¬´${movie.title}¬ª –≤ –∂–∞–Ω—Ä–µ ${genres.join(', ').toLowerCase()} –≤—ã—à–µ–ª –≤ ${movie.release_date.slice(0, 4)} –≥–æ–¥—É. –†–µ–∂–∏—Å—Å—ë—Ä ‚Äî ${director}. –í –≥–ª–∞–≤–Ω—ã—Ö —Ä–æ–ª—è—Ö: ${actors.join(', ')}.</p>
      <p>–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—É—á–∏–ª –æ—Ü–µ–Ω–∫—É ${movie.vote_average.toFixed(1)} –Ω–∞ TMDB –Ω–∞ –æ—Å–Ω–æ–≤–µ ${movie.vote_count} –≥–æ–ª–æ—Å–æ–≤. –ï—Å–ª–∏ –≤—ã –ª—é–±–∏—Ç–µ ${genres.join(', ').toLowerCase()}, —ç—Ç–æ—Ç —Ñ–∏–ª—å–º –≤–∞–º —Ç–æ—á–Ω–æ –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è.</p>
    `;

    // Schema.org JSON-LD
    const schema = {
      "@context": "https://schema.org",
      "@type": "Movie",
      "name": movie.title,
      "description": movie.overview,
      "datePublished": movie.release_date,
      "url": location.href,
      "image": poster,
      "genre": genres,
      "inLanguage": "ru",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": movie.vote_average.toFixed(1),
        "ratingCount": movie.vote_count,
        "bestRating": "10",
        "worstRating": "1"
      },
      "director": { "@type": "Person", "name": director },
      "actor": actors.map(name => ({ "@type": "Person", "name": name }))
    };
    const script = document.createElement('script');
    script.type = 'application/ld+json';
    script.textContent = JSON.stringify(schema);
    document.head.appendChild(script);
  }

  async function loadTrailer() {
    const res = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/videos?api_key=${API_KEY}&language=ru-RU`);
    const data = await res.json();
    const trailer = data.results.find(v => v.type === 'Trailer' && v.site === 'YouTube');
    if (trailer) {
      const wrapper = document.getElementById('videoWrapper');
      const thumb = document.getElementById('videoThumb');
      thumb.src = `https://img.youtube.com/vi/${trailer.key}/hqdefault.jpg`;
      wrapper.style.display = 'block';
      wrapper.onclick = () => {
        wrapper.innerHTML = '';
        const iframe = document.createElement('iframe');
        iframe.src = `https://www.youtube.com/embed/${trailer.key}?autoplay=1`;
        iframe.allowFullscreen = true;
        iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
        iframe.style.width = '100%';
        iframe.style.height = '100%';
        iframe.style.border = 'none';
        wrapper.appendChild(iframe);
      };
    }
  }

  loadMovie();
  loadTrailer();
</script>

</body>
</html>
