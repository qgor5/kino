<script>
  // Список статей с URL, можно расширить
  const articles = [
    { url: 'karate-kid-2025.html' },
    { url: 'some-other-article.html' }
  ];

  async function fetchArticleData(url) {
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`Ошибка загрузки: ${url}`);
      const text = await res.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');

      // Заголовок
      const title = doc.querySelector('meta[property="og:title"]')?.content
                  || doc.querySelector('title')?.textContent
                  || 'Без названия';

      // Описание
      const description = doc.querySelector('meta[property="og:description"]')?.content
                        || doc.querySelector('meta[name="description"]')?.content
                        || 'Описание отсутствует';

      // Картинка
      let image = doc.querySelector('meta[property="og:image"]')?.content;
      if (!image) {
        const imgEl = doc.querySelector('article img, main img, img');
        if (imgEl) image = imgEl.src || imgEl.getAttribute('src');
      }
      if (!image) {
        image = 'https://via.placeholder.com/300x140?text=No+Image';
      }

      return { title, description, image, url };
    } catch (e) {
      console.error('Ошибка при загрузке статьи:', url, e);
      return null;
    }
  }

  async function renderPosts() {
    const container = document.getElementById('posts-container');
    container.innerHTML = ''; // Очистить контейнер перед добавлением
    for (const article of articles) {
      const data = await fetchArticleData(article.url);
      if (!data) continue;

      const articleEl = document.createElement('article');
      articleEl.className = 'post-card';
      articleEl.setAttribute('itemscope', '');
      articleEl.setAttribute('itemtype', 'https://schema.org/Article');

      articleEl.innerHTML = `
        <a href="${data.url}" itemprop="url" title="${data.title}">
          <img src="${data.image}" alt="${data.title}" class="post-image" itemprop="image" loading="lazy" />
          <h2 class="post-title" itemprop="headline">${data.title}</h2>
          <p class="post-excerpt" itemprop="description">${data.description}</p>
          <meta itemprop="author" content="TopKino" />
          <meta itemprop="publisher" content="TopKino" />
        </a>
      `;
      container.appendChild(articleEl);
    }
  }

  // Запускаем подгрузку при загрузке страницы
  document.addEventListener('DOMContentLoaded', renderPosts);
</script>
